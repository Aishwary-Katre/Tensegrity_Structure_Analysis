
clc
clear all
clc
nodes = 12;
d =3;
h = d+1;
C = [0 0 0 0 0 1 0 -1 0 0 0 0; 0 0 0 0 1 0 0 0 -1 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 -1; 0 0 1 0 0 0 0 0 0 0 -1 0; 1 0 0 0 0 0 0 0 0 -1 0 0; 0 1 0 0 0 0 -1 0 0 0 0 0; 0 0 0 1 -1 0 0 0 0 0 0 0; 0 0 0 0 1 -1 0 0 0 0 0 0; 0 0 0 1 0 -1 0 0 0 0 0 0; 1 -1 0 0 0 0 0 0 0 0 0 0; 1 0 -1 0 0 0 0 0 0 0 0 0; 0 1 -1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 -1 0; 0 0 0 0 0 0 0 0 0 0 1 -1; 0 0 0 0 0 0 1 -1 0 0 0 0; 0 0 0 0 0 0 1 0 -1 0 0 0; 0 0 0 0 0 0 0 1 0 -1 0 0; 0 0 0 0 0 0 0 0 0 1 0 -1; 0 1 0 0 0 0 0 0 0 0 -1 0; 0 0 1 0 0 0 0 0 0 -1 0 0; 1 0 0 0 0 0 -1 0 0 0 0 0; 0 0 0 0 0 1 0 0 -1 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 -1; 0 0 0 1 0 0 0 -1 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 -1 0; 0 0 0 0 0 1 -1 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 -1 0 0; 1 0 0 0 0 0 0 -1 0 0 0 0; 0 1 0 0 0 0 0 0 -1 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 -1];
q = [-1.5 -1.5 -1.5 -1.5 -1.5 -1.5 1 1 1 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1];
B1 = [0 0 0 0 1 0 0 0 0 1, 1 0 0 0 0 0 0 0 0 0, 1 0 0 0 0 0 0 1 0 0 ; 0 0 0 0 0 0 0 0 0 -1, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, -1 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, -1 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 -1 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 -1 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B2 = [0 0 0 0 0 0 0 0 0 -1, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 1 0 0 0 1, 0 1 0 0 0 0 0 0 1 0, 0 0 0 0 0 0 0 0 1 0 ; 0 0 0 0 0 0 0 0 0 0, 0 -1 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 -1 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 -1 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 -1 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B3 = [0 0 0 0 0 0 0 0 0 0, -1 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 -1 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 1 0 0 0 0 0 0, 1 1 0 0 0 0 0 0 0 1, 0 0 0 0 0 0 0 0 0 1 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 -1, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 -1 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 -1];
B4 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 1 0 0 0 1 0 1 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 1 0 0 1 0 0 0 ; 0 0 0 0 0 0 -1 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 -1 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 -1 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 -1 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 -1 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B5 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 -1 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 1 0 0 0 0 1 1 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 1 0 1 0 0 0 0 0 ; 0 0 0 0 0 0 0 -1 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 -1 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 -1 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 -1 0 0 0 0 0 0 0];
B6 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 -1 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 -1 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 1 0 0 0 0 0 0 1 1 0, 0 0 0 0 0 0 0 0 0 0, 0 1 0 0 0 1 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 -1 0 0 0 0 ; -1 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 -1 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B7 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, -1 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 -1 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 -1 0 0 0 0 ; 0 0 0 0 0 1 0 0 0 0, 0 0 0 0 1 1 0 0 0 0, 1 0 0 0 0 1 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 -1 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 -1 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B8 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 -1 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 -1 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; -1 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 -1 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 1 0 0 0 0 0 0 0 0 0, 0 0 0 0 1 0 1 0 0 0, 0 0 0 1 0 0 0 1 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 -1 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B9 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 -1 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 -1 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 -1 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 -1 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 1 0 0 0 0 0 0 0 0, 0 0 1 0 0 1 0 0 0 0, 0 1 0 0 0 0 0 0 1 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 -1 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B10 = [0 0 0 0 -1 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 -1, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 -1 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 -1 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 1 0 0 0 0 0, 0 0 0 0 0 0 1 1 0 1, 0 0 0 0 0 0 1 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 -1 0 0, 0 0 0 0 0 0 0 0 0 0];
B11 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 -1 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 -1 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 -1 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ;0 0 0 0 0 0 0 0 0 0, 0 0 -1 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 1 0 0 0 0 0 0, 0 0 1 1 0 0 0 0 1 0, 0 0 0 0 1 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 -1 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0];
B12 = [0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 -1 ; 0 0 -1 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 -1 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 0 0 0 0 -1 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0 0, 0 0 0 -1 0 0 0 0 0 0, 0 0 0 0 0 0 0 0 0 0 ; 0 0 1 0 0 0 0 0 0 0, 0 0 0 1 0 0 0 1 0 0, 0 0 1 0 0 0 0 0 0 1];
B = [B1;B2;B3;B4;B5;B6;B7;B8;B9;B10;B11;B12];
count = 0;
rankdef =0;
 while rankdef ~= h
Q = diag(q);
E = C'*Q*C;
[V, lambda] = eig(E);
for i=1:4
      lambda(i,i) = 0;
end
Ebar = V*lambda*V';
gbar = [Ebar(1,:)';Ebar(2,:)';Ebar(3,:)';Ebar(4,:)';Ebar(5,:)';Ebar(6,:)';Ebar(7,:)';Ebar(8,:)';Ebar(9,:)';Ebar(10,:)';Ebar(11,:)';Ebar(12,:)'];
qbar = ((B'*B)\B')*gbar;
Qbar = diag(qbar);
Enxt = C'*Qbar*C;
Rn = rank(Enxt);
rankdef1= nodes-Rn;
rankdef = rankdef1;
q = qbar;
qfinal = qbar'
Efinal = Enxt;
count  = count+1;
 end
 %%%%%%%%%%%%%%%%%%%%%%%%%   Geometry Realization Part    %%%%%%%%%%%%%%%%%%%%%%%
I = eye(3);
H = kron(I,Efinal);
A = null(H);
RR = rref(A');
Abr = [A(2,:);A(7,:);A(9,:);A(11,:);A(14,:);A(19,:);A(21,:);A(23,:);A(26,:);A(31,:);A(33,:);A(35,:)];
Xbr = [1.3333 -1.8867 -2.6667 1.3334 -2.3094 1.6666 0 2.3094 0 3.3333 0 0]';
X = (A*inv(Abr))*Xbr;
x = [X(1:12)]'
y = [X(13:24)]'
z = [X(25:36)]'
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   Plotting tensegrity structure  %%%%%%%%%%%%%
 hold all
 grid on
 view(90,80) % Azimuth and elevation view
%closing the triangle
Xc = [x(1:3),x(1)];
Yc = [y(1:3),y(1)];
Zc = [z(1:3),z(1)];
Xcd = [x(4:6),x(4)];
Ycd = [y(4:6),y(4)];
Zcd = [z(4:6),z(4)];
plot3(Xc,Yc,Zc,'Color','b','LineWidth',2) % greenfor cables
plot3(Xcd,Ycd,Zcd,'Color','b','LineWidth',2) % greenfor cables
%preparing coordinates for bras
Xb1 = [x(6) x(8);x(3) x(11)];
Yb1 = [y(6) y(8);y(3) y(11)];
Zb1 = [z(6) z(8);z(3) z(11)];
Xb2 = [x(5) x(9);x(1) x(10)];
Yb2 = [y(5) y(9);y(1) y(10)];
Zb2 = [z(5) z(9);z(1) z(10)];
Xb3 = [x(2) x(7);x(4) x(12)];
Yb3 = [y(2) y(7);y(4) y(12)];
Zb3 = [z(2) z(7);z(4) z(12)];
for i = 1:2
 plot3(Xb1(i,:),Yb1(i,:),Zb1(i,:),'Color','k','LineWidth',4) 
  plot3(Xb2(i,:),Yb2(i,:),Zb2(i,:),'Color','r','LineWidth',4) 
   plot3(Xb3(i,:),Yb3(i,:),Zb3(i,:),'Color','g','LineWidth',4) 
 
end
Xs = [x(9) x(11); x(11) x(12); x(7) x(8); x(7) x(9); x(8) x(10); x(10) x(12)];
Ys = [y(9) y(11); y(11) y(12); y(7) y(8); y(7) y(9); y(8) y(10); y(10) y(12)];
Zs = [z(9) z(11); z(11) z(12); z(7) z(8); z(7) z(9); z(8) z(10); z(10) z(12)];
Xd = [x(5) x(11); x(6) x(7); x(4) x(10); x(1) x(8); x(2) x(9); x(3) x(12)];
Yd = [y(5) y(11); y(6) y(7); y(4) y(10); y(1) y(8); y(2) y(9); y(3) y(12)];
Zd = [z(5) z(11); z(6) z(7); z(4) z(10); z(1) z(8); z(2) z(9); z(3) z(12)];
Xv = [ x(1) x(7);x(2) x(11); x(3) x(10); x(6) x(9); x(5) x(12); x(4) x(8)];
Yv = [y(1) y(7);y(2) y(11); y(3) y(10);  y(6) y(9); y(5) y(12); y(4) y(8)];
Zv = [z(1) z(7);z(2) z(11); z(3) z(10);  z(6) z(9); z(5) z(12); z(4) z(8)];
for i = 1:6
  
   plot3(Xs(i,:),Ys(i,:),Zs(i,:),'Color','b','LineWidth',2) 
   plot3(Xd(i,:),Yd(i,:),Zd(i,:),'Color','b','LineWidth',2) 
   plot3(Xv(i,:),Yv(i,:),Zv(i,:),'Color','b','LineWidth',2) 
    %scatter3([x(i) x(i+6)],[x(i) y(i+6)],[z(i) z(i+6)],'filled'),...'MarkerFaceColor','k')
end
str = string(1:12);
text(x,y,z,str,'FontSize',20)
% scatter3(Xc,Yc,Zc,'filled','MarkerFaceColor','b','LineWidth',20)
% scatter3(Xcd,Ycd,Zcd,'filled','MarkerFaceColor','b','LineWidth',20)
% scatter3(Xb1,Yb1,Zb1,'filled','MarkerFaceColor','b','LineWidth',20)
% scatter3(Xb2,Yb2,Zb2,'filled','MarkerFaceColor','b','LineWidth',20)
% scatter3(Xb3,Yb3,Zb3,'filled','MarkerFaceColor','b','LineWidth',20)
xlabel('xaxis')
ylabel('yaxis')
zlabel('zaxis')



%%%%%%%%%%%%   Plotting Strain energy %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
































